{"version":3,"sources":["uni-app:///main.js","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/shops/collect.vue?d07e","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/shops/collect.vue?68a9","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/shops/collect.vue?8b08","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/shops/collect.vue?d153","uni-app:///shops/collect.vue","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/shops/collect.vue?ea33","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/shops/collect.vue?0257"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","formData","address","name","residence","province","city","district","shopImages","videoUrl","rent","area","imgUrl","shopSize","menkuan","waibai","nianxian","dizneg","norent","dian","shui","yajin","zhuanrangfei","acondition","guanggao","allDesc","region","methods","regionChange","takePhoto","uni","title","icon","count","sizeType","sourceType","success","fail","console","uploadImage","util","then","that","duration","catch","deleteImage","takeVideo","maxDuration","camera","compressed","uploadVideo","url","filePath","header","deleteVideo","submitForm","mask","delta"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,gBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoH;AACpH;AAC2D;AACL;AACa;;;AAGnE;AACmM;AACnM,gBAAgB,6MAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,kFAAM;AACR,EAAE,2FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,sFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAowB,CAAgB,ixBAAG,EAAC,C;;;;;;;;;;;;;;;;;;ACuLxxB;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AALA;AAAA,eAMA;EACAC;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MAGA;MACAC;IACA;EACA;;EACAC;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MAAA;MACA;MACA;QACAC;UACAC;UACAC;QACA;QACA;MACA;MAEAF;QACAG;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;UACA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;QACAC;UACAC;UACAR;YACAC;YACAC;UACA;QACA;MACA;IACA;IAEA;IACAO;MACAD;;MAEA;MACA;MAEAR;QACAC;MACA;MAEA;QACA;QACA;QAEA;UACA;QACA;QAEAS,yDACAC;UACAX;;UAEA;YACA;YACAY;YACAJ;YACAR;cACAC;cACAC;YACA;UACA;YACA;YACAU;YACAJ;YACAR;cACAE;cACAD;cACAY;YACA;UACA;QACA,GACAC;UACAd;UACA;UACAY;UACAJ;UACAR;YACAE;YACAD;YACAY;UACA;QACA;MACA;QACAb;QACA;QACAY;QACAJ;QACAR;UACAE;UACAD;UACAY;QACA;MACA;IACA;IAEA;IACAE;MACA;IACA;IACA;IACAC;MAAA;MACAhB;QACAK;QAAA;QACAY;QAAA;QACAC;QAAA;QACAC;QAAA;QACAb;UACA;UACA;UACA;UACA;UACA;UACA;QACA;QACAC;UACAC;UACAR;YACAC;YACAC;UACA;QACA;MACA;IACA;IAEA;IACAkB;MACAZ;;MAEA;MACA;MAEAR;QACAC;MACA;;MAGA;MACAD;QACAqB;QAAA;QACAC;QAAA;QACAjD;QAAA;QACAkD;UACA;QACA;QACAjB;UACAN;UAEAQ;;UAEA;UACA;UACA;YACA;YACAI;YACAJ;YACAR;cACAC;cACAC;YACA;UACA;YACAM;YACAR;cACAE;cACAD;cACAY;YACA;UACA;QACA;QACAN;UACAP;UACAQ;UACAR;YACAE;YACAD;YACAY;UACA;QACA;MACA;IACA;IACA;IACAW;MACA;MACAxB;QACAC;QACAC;MACA;IACA;IACA;IACAuB;MACA;QACAzB;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MAEA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MAEA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MACA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MAEA;MACA;MACAM;MAEAR;QACAC;QACAyB;MACA;MACAhB;QACAV;QACA;UACAA;YACA2B;UACA;QACA;UACA3B;YACAE;YACAD;YACAY;UACA;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACnkBA;AAAA;AAAA;AAAA;AAAulC,CAAgB,skCAAG,EAAC,C;;;;;;;;;;;ACA3mC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"shops/collect.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './shops/collect.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./collect.vue?vue&type=template&id=02aafaba&\"\nvar renderjs\nimport script from \"./collect.vue?vue&type=script&lang=js&\"\nexport * from \"./collect.vue?vue&type=script&lang=js&\"\nimport style0 from \"./collect.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"shops/collect.vue\"\nexport default component.exports","export * from \"-!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./collect.vue?vue&type=template&id=02aafaba&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.formData.shopImages.length\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./collect.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./collect.vue?vue&type=script&lang=js&\"","<template>\r\n    <view class=\"container\">\r\n\r\n        <!-- 原有的内容 -->\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>1：店铺名称</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.name\" placeholder=\"请输入店铺名称\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>2：店铺所在的地区</view>\r\n            <view class=\"input-wrap\">\r\n                <picker mode=\"region\" @change=\"regionChange\" :value=\"region\">\r\n                    <view class=\"picker-content\">\r\n                        {{ region[0] + ' ' + region[1] + ' ' + region[2] || '请选择店铺所在的地区' }}\r\n                    </view>\r\n                </picker>\r\n            </view>\r\n        </view>\r\n\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>3：店铺具体地址</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.address\" placeholder=\"请输入店铺具体地址\" />\r\n            </view>\r\n        </view>\r\n\r\n       \r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>5：店铺面积</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.shopSize\" placeholder=\"请输入店铺面积(m²)\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>6：店铺门宽</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.menkuan\" placeholder=\"请输入店铺门宽\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>7：店铺外摆</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.waibai\" placeholder=\"请输入店铺外摆\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>8：店铺年限</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.nianxian\" placeholder=\"请输入店铺年限\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>9：店铺租金 （元/月）</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.rent\" placeholder=\"请输入店铺租金\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>10：店铺租金年递增</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.dizneg\" placeholder=\"请输入店铺租金年递增\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>11：店铺装修免租期</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.norent\" placeholder=\"请输入店铺装修免租期\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>12：店铺电费</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.dian\" placeholder=\"请输入店铺电费\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>13：店铺水费</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.shui\" placeholder=\"请输入店铺水费\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>14：店铺装修押金</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.yajin\" placeholder=\"请输入店铺装修押金\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>15：店铺转让费</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.zhuanrangfei\" placeholder=\"请输入店铺转让费\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>16：店铺工程条件</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.acondition\" placeholder=\"请输入店铺工程条件\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>17：店铺广告位</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.guanggao\" placeholder=\"请输入店铺广告位\" />\r\n            </view>\r\n        </view>\r\n\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>18：店铺总结</view>\r\n            <view class=\"input-wrap\">\r\n                <input type=\"text\" v-model=\"formData.allDesc\" placeholder=\"请输入店铺总结\" />\r\n            </view>\r\n        </view>\r\n\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>19：店铺照片</view>\r\n            <view class=\"photo-wrap\">\r\n                <!-- 已上传的图片列表 -->\r\n                <view class=\"photo-list\">\r\n                    <view class=\"photo-preview\" v-for=\"(img, index) in formData.shopImages\" :key=\"index\">\r\n                        <image :src=\"img\" mode=\"aspectFill\"></image>\r\n                        <view class=\"photo-delete\" @tap=\"deleteImage(index)\">×</view>\r\n                    </view>\r\n\r\n                    <!-- 添加图片按钮，当图片数量少于3张时显示 -->\r\n                    <view class=\"photo-upload\" @tap=\"takePhoto\" v-if=\"formData.shopImages.length < 3\">\r\n                        <text class=\"cuIcon-camera\"></text>\r\n                        <text>拍摄照片</text>\r\n                    </view>\r\n                </view>\r\n                <view class=\"photo-tip\">最多可上传3张照片</view>\r\n            </view>\r\n        </view>\r\n\r\n        <!-- 新增视频上传部分 -->\r\n        <view class=\"question-item\">\r\n            <view class=\"question-title\"><text class=\"required\">*</text>20：店铺视频</view>\r\n            <view class=\"video-wrap\">\r\n                <!-- 已上传的视频预览 -->\r\n                <view class=\"video-preview\" v-if=\"formData.videoUrl\">\r\n                    <video :src=\"formData.videoUrl\" controls></video>\r\n                    <view class=\"video-controls\">\r\n                        <view class=\"video-delete-btn\" @tap=\"deleteVideo\">删除视频</view>\r\n                    </view>\r\n                </view>\r\n\r\n                <!-- 添加视频按钮，当没有视频时显示 -->\r\n                <view class=\"video-upload\" @tap=\"takeVideo\" v-if=\"!formData.videoUrl\">\r\n                    <text class=\"cuIcon-video\"></text>\r\n                    <text>拍摄视频</text>\r\n                </view>\r\n                <view class=\"video-tip\">可上传一段不超过60秒的视频</view>\r\n            </view>\r\n        </view>\r\n\r\n\r\n\r\n        <view class=\"submit-wrap\">\r\n            <button @tap=\"submitForm\" class=\"submit-btn\">提交</button>\r\n        </view>\r\n    </view>\r\n</template>\r\n\r\n<script>\r\nconst util = require(\"@/utils/util.js\")\r\nimport {\r\n    setUserInfo,\r\n    getUserInfo\r\n} from '@/utils/auth';\r\nimport { baseUrl } from '../utils/apiconfig';\r\nexport default {\r\n    data() {\r\n        return {\r\n            formData: {\r\n                address: '',\r\n                name: '',\r\n                residence: '',\r\n                province: '', // 新增省份字段\r\n                city: '', // 新增城市字段\r\n                district: '', // 新增区县字段\r\n                shopImages: [], // 修改为数组，存储多张图片\r\n                videoUrl: '', // 新增视频字段\r\n                rent:'',\r\n                area:'',\r\n                imgUrl:'',\r\n                shopSize:'',\r\n                menkuan:'',\r\n                waibai:'',\r\n                nianxian:'',\r\n                dizneg:'',\r\n                norent:'',\r\n                dian:\"\",\r\n                shui:\"\",\r\n                yajin:\"\",\r\n                zhuanrangfei:\"\",\r\n                acondition:\"\",\r\n                guanggao:\"\",\r\n                allDesc:\"\",\r\n\r\n\r\n            },\r\n            region: ['', '', ''], // 存储省市区选择结果\r\n        }\r\n    },\r\n    methods: {\r\n        // 新增省市区选择器变化事件处理函数\r\n        regionChange(e) {\r\n            this.region = e.detail.value;\r\n            this.formData.province = this.region[0];\r\n            this.formData.city = this.region[1];\r\n            this.formData.district = this.region[2];\r\n            // 同时更新residence字段，保持兼容性\r\n            this.formData.residence = this.region.join(' ');\r\n        },\r\n        // 拍照方法\r\n        takePhoto() {\r\n            // 如果已经有3张图片，不再允许上传\r\n            if (this.formData.shopImages.length >= 3) {\r\n                uni.showToast({\r\n                    title: '最多只能上传3张图片',\r\n                    icon: 'none'\r\n                });\r\n                return;\r\n            }\r\n\r\n            uni.chooseImage({\r\n                count: 1, // 每次选择1张图片\r\n                sizeType: ['compressed'], // 可以指定是原图还是压缩图，默认二者都有\r\n                sourceType: ['camera', 'album'], // 从相机拍摄或相册选择\r\n                success: (res) => {\r\n                    // 返回选定照片的本地文件路径列表\r\n                    const tempFilePath = res.tempFilePaths[0];\r\n                    // 先将本地图片路径添加到数组，让用户立即看到拍摄的照片\r\n                    const tempIndex = this.formData.shopImages.length;\r\n                    this.formData.shopImages.push(tempFilePath);\r\n                    // 然后上传图片到服务器\r\n                    this.uploadImage(tempFilePath, tempIndex);\r\n                },\r\n                fail: (err) => {\r\n                    console.error('选择图片失败', err);\r\n                    uni.showToast({\r\n                        title: '选择图片失败',\r\n                        icon: 'none'\r\n                    });\r\n                }\r\n            });\r\n        },\r\n\r\n        // 上传图片到服务器\r\n        uploadImage(filePath, index) {\r\n            console.log('上传图片：', filePath, '索引：', index);\r\n\r\n            // 保存当前页面的this引用\r\n            const that = this;\r\n\r\n            uni.showLoading({\r\n                title: '上传中...'\r\n            });\r\n\r\n            try {\r\n                // 微信小程序读取文件\r\n                const base64 = 'data:image/jpeg;base64,' + wx.getFileSystemManager().readFileSync(filePath, 'base64');\r\n\r\n                var reqData = {\r\n                    \"base64Str\": base64\r\n                };\r\n\r\n                util.request(\"common/uploadImageWater\", reqData, \"POST\")\r\n                    .then((res) => {\r\n                        uni.hideLoading(); // 在请求完成后隐藏加载提示\r\n\r\n                        if (res.code === 200) {\r\n                            // 更新对应索引位置的图片URL为服务器返回的URL\r\n                            that.formData.shopImages[index] = res.url;\r\n                            console.log(\"上传成功，图片URL:\", res.url, \"索引：\", index);\r\n                            uni.showToast({\r\n                                title: '上传成功',\r\n                                icon: 'success'\r\n                            });\r\n                        } else {\r\n                            // 上传失败，从数组中移除该图片\r\n                            that.formData.shopImages.splice(index, 1);\r\n                            console.error('上传失败', res);\r\n                            uni.showToast({\r\n                                icon: \"none\",\r\n                                title: res.msg || \"上传失败，请稍后再试\",\r\n                                duration: 2000\r\n                            });\r\n                        }\r\n                    })\r\n                    .catch((err) => {\r\n                        uni.hideLoading();\r\n                        // 上传失败，从数组中移除该图片\r\n                        that.formData.shopImages.splice(index, 1);\r\n                        console.error('上传请求失败', err);\r\n                        uni.showToast({\r\n                            icon: \"none\",\r\n                            title: \"网络错误，请稍后再试\",\r\n                            duration: 2000\r\n                        });\r\n                    });\r\n            } catch (e) {\r\n                uni.hideLoading();\r\n                // 上传失败，从数组中移除该图片\r\n                that.formData.shopImages.splice(index, 1);\r\n                console.error('上传过程发生错误', e);\r\n                uni.showToast({\r\n                    icon: \"none\",\r\n                    title: \"上传失败，请稍后再试\",\r\n                    duration: 2000\r\n                });\r\n            }\r\n        },\r\n\r\n        // 删除图片\r\n        deleteImage(index) {\r\n            this.formData.shopImages.splice(index, 1);\r\n        },\r\n        // 拍摄视频方法\r\n        takeVideo() {\r\n            uni.chooseVideo({\r\n                sourceType: ['camera', 'album'], // 从相机拍摄或相册选择\r\n                maxDuration: 60, // 最长拍摄时间，单位秒\r\n                camera: 'back', // 默认拉起后置摄像头\r\n                compressed: true, // 是否压缩所选视频\r\n                success: (res) => {\r\n                    // 返回选定视频的本地文件路径\r\n                    const tempFilePath = res.tempFilePath;\r\n                    // 先将本地视频路径添加到数据模型，让用户立即看到拍摄的视频\r\n                    // this.formData.videoUrl = tempFilePath;\r\n                    // 然后上传视频到服务器\r\n                    this.uploadVideo(tempFilePath);\r\n                },\r\n                fail: (err) => {\r\n                    console.error('选择视频失败', err);\r\n                    uni.showToast({\r\n                        title: '选择视频失败',\r\n                        icon: 'none'\r\n                    });\r\n                }\r\n            });\r\n        },\r\n\r\n        // 上传视频到服务器\r\n        uploadVideo(filePath) {\r\n            console.log('上传视频：', filePath);\r\n\r\n            // 保存当前页面的this引用\r\n            const that = this;\r\n\r\n            uni.showLoading({\r\n                title: '上传中...'\r\n            });\r\n\r\n\r\n            // 使用uni.uploadFile上传视频文件\r\n            uni.uploadFile({\r\n                url: baseUrl + 'common/upload', // SpringBoot接收视频的接口\r\n                filePath: filePath, // 临时视频路径\r\n                name: 'file', // 文件对应的 key，开发者在服务器端通过这个 key 获取文件的二进制内容\r\n                header: {\r\n                    'Authorization': util.getToken()\r\n                },\r\n                success: (res) => {\r\n                    uni.hideLoading();\r\n\r\n                   console.log('上传响应：', res);\r\n\r\n                    // 解析服务器返回的JSON数据\r\n                    const resData = JSON.parse(res.data);\r\n                    if (resData.code === 200) {\r\n                        // 更新视频URL为服务器返回的URL\r\n                        that.formData.videoUrl = resData.url;\r\n                        console.log(\"上传成功，视频URL:\", resData.url);\r\n                        uni.showToast({\r\n                            title: '上传成功',\r\n                            icon: 'success'\r\n                        });\r\n                    } else {\r\n                        console.error('上传失败', res);\r\n                        uni.showToast({\r\n                            icon: \"none\",\r\n                            title: res.msg || \"上传失败，请稍后再试\",\r\n                            duration: 2000\r\n                        });\r\n                    }\r\n                },\r\n                fail: (err) => {\r\n                    uni.hideLoading();\r\n                    console.error('上传请求失败', err);\r\n                    uni.showToast({\r\n                        icon: \"none\",\r\n                        title: \"网络错误，请稍后再试\",\r\n                        duration: 2000\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        // 删除视频\r\n        deleteVideo() {\r\n            this.formData.videoUrl = '';\r\n            uni.showToast({\r\n                title: '视频已删除',\r\n                icon: 'success'\r\n            });\r\n        },\r\n        // 修改提交表单方法，添加照片验证\r\n        submitForm() {\r\n            if (!this.formData.name) {\r\n                uni.showToast({\r\n                    title: '请输入店铺名称',\r\n                    icon: 'none'\r\n                });\r\n                return;\r\n            }\r\n            if (!this.formData.province || !this.formData.city || !this.formData.district) {\r\n                uni.showToast({\r\n                    title: '请选择店铺所在地区',\r\n                    icon: 'none'\r\n                });\r\n                return;\r\n            }\r\n            \r\n            if (!this.formData.address) {\r\n                uni.showToast({\r\n                    title: '请输入店铺详细地址',\r\n                    icon: 'none'\r\n                });\r\n                return; \r\n            }\r\n            \r\n            if (!this.formData.shopSize) {\r\n                uni.showToast({\r\n                    title: '请输入店铺面积',\r\n                    icon: 'none'\r\n                });\r\n                return; \r\n            }\r\n            if (!this.formData.menkuan) {\r\n                uni.showToast({\r\n                    title: '请输入店铺门宽',\r\n                    icon: 'none'\r\n                });\r\n                return; \r\n            }\r\n            if (!this.formData.waibai) {\r\n                uni.showToast({\r\n                    title: '请输入店铺外摆',\r\n                    icon: 'none'\r\n                });\r\n                return; \r\n            }\r\n            if (!this.formData.nianxian) {\r\n                uni.showToast({\r\n                    title: '请输入店铺年限',\r\n                    icon: 'none'\r\n                });\r\n                return; \r\n            }\r\n            if (!this.formData.rent) {\r\n                uni.showToast({\r\n                    title: '请输入店铺租金',\r\n                    icon: 'none'\r\n                });\r\n                return; \r\n            }\r\n            if (!this.formData.dizneg) {\r\n                uni.showToast({\r\n                    title: '请输入店铺租金年递增',\r\n                    icon: 'none'\r\n                });\r\n                return; \r\n            }\r\n            if (!this.formData.norent) {\r\n                uni.showToast({\r\n                    title: '请输入店铺装修免租期',\r\n                    icon: 'none'\r\n                });\r\n                return; \r\n            }\r\n            if (!this.formData.dian) {\r\n                uni.showToast({\r\n                    title: '请输入店铺电费',\r\n                    icon: 'none'\r\n                });\r\n                return; \r\n            }\r\n            if (!this.formData.shui) {\r\n                uni.showToast({\r\n                    title: '请输入店铺水费',\r\n                    icon: 'none'\r\n                });\r\n                return;\r\n            }\r\n            if(!this.formData.yajin){\r\n                uni.showToast({\r\n                    title: '请输入店铺押金',\r\n                    icon: 'none'\r\n                });\r\n                return;\r\n            }\r\n            if(!this.formData.zhuanrangfei){\r\n                uni.showToast({\r\n                    title: '请输入店铺转让费',\r\n                    icon: 'none'\r\n                });\r\n                return;\r\n            }\r\n            if(!this.formData.acondition){\r\n                uni.showToast({\r\n                    title: '请输入店铺工程条件',\r\n                    icon: 'none'\r\n                });\r\n                return;\r\n            }\r\n            if(!this.formData.guanggao){\r\n                uni.showToast({\r\n                    title: '请输入店铺广告位',\r\n                    icon: 'none'\r\n                });\r\n                return;\r\n            }\r\n            if(this.formData.shopImages.length<=0){\r\n                uni.showToast({\r\n                    title: '请上传店铺照片',\r\n                    icon: 'none'\r\n                });\r\n                return;\r\n            }\r\n            if (!this.formData.videoUrl) {\r\n                uni.showToast({\r\n                    title: '请上传店铺视频',\r\n                    icon: 'none'\r\n                });\r\n                return; \r\n            }\r\n            \r\n            this.formData.area = this.formData.province + ',' + this.formData.city + ',' + this.formData.district;\r\n            this.formData.imgUrl = this.formData.shopImages.join(',');\r\n            console.log('表单数据：', this.formData);\r\n            \r\n            uni.showLoading({\r\n                title: '提交中',\r\n                mask: true\r\n            })\r\n            util.request(\"wx/api/insertShop\", this.formData, \"POST\").then(function (res) {\r\n                uni.hideLoading();\r\n                if (res.code === 200) {\r\n                    uni.navigateBack({\r\n                        delta: 1\r\n                    });\r\n                } else {\r\n                    uni.showToast({\r\n                        icon: \"none\",\r\n                        title: res.msg,\r\n                        duration: 2000\r\n                    })\r\n                }\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n.container {\r\n    padding: 30rpx;\r\n    background: #fff;\r\n}\r\n\r\n.question-item {\r\n    margin-bottom: 40rpx;\r\n}\r\n\r\n.question-title {\r\n    font-size: 28rpx;\r\n    color: #333;\r\n    margin-bottom: 20rpx;\r\n}\r\n\r\n.select-wrap {\r\n    padding: 0 20rpx;\r\n}\r\n\r\n.picker-content {\r\n    height: 80rpx;\r\n    line-height: 80rpx;\r\n    background: #f8f8f8;\r\n    border-radius: 8rpx;\r\n    padding: 0 20rpx;\r\n    font-size: 28rpx;\r\n    color: #333;\r\n}\r\n\r\n.input-wrap {\r\n    padding: 20rpx;\r\n}\r\n\r\n.input-wrap input {\r\n    width: 100%;\r\n    height: 80rpx;\r\n    background: #f8f8f8;\r\n    border-radius: 8rpx;\r\n    padding: 0 20rpx;\r\n    font-size: 28rpx;\r\n}\r\n\r\n.submit-wrap {\r\n    margin-top: 60rpx;\r\n    padding: 0 40rpx;\r\n}\r\n\r\n.submit-btn {\r\n    width: 100%;\r\n    height: 88rpx;\r\n    line-height: 88rpx;\r\n    background: #2979FF;\r\n    color: #fff;\r\n    font-size: 32rpx;\r\n    border-radius: 8rpx;\r\n    margin-bottom: 40rpx;\r\n}\r\n\r\n.required {\r\n    color: #ff0000;\r\n}\r\n\r\n.photo-wrap {\r\n    padding: 20rpx;\r\n}\r\n\r\n.photo-list {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    margin: -10rpx;\r\n}\r\n\r\n.photo-preview {\r\n    position: relative;\r\n    width: 200rpx;\r\n    height: 200rpx;\r\n    border-radius: 8rpx;\r\n    overflow: hidden;\r\n    margin: 10rpx;\r\n}\r\n\r\n.photo-preview image {\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\n.photo-delete {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    width: 40rpx;\r\n    height: 40rpx;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    color: #fff;\r\n    text-align: center;\r\n    line-height: 40rpx;\r\n    font-size: 32rpx;\r\n}\r\n\r\n.photo-upload {\r\n    width: 200rpx;\r\n    height: 200rpx;\r\n    background: #f8f8f8;\r\n    border-radius: 8rpx;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n    color: #999;\r\n    margin: 10rpx;\r\n}\r\n\r\n.photo-upload .cuIcon-camera {\r\n    font-size: 48rpx;\r\n    margin-bottom: 10rpx;\r\n}\r\n\r\n.photo-tip {\r\n    font-size: 24rpx;\r\n    color: #999;\r\n    margin-top: 10rpx;\r\n    padding-left: 10rpx;\r\n}\r\n\r\n/* 视频上传相关样式 */\r\n.video-wrap {\r\n    padding: 20rpx;\r\n}\r\n\r\n.video-preview {\r\n    position: relative;\r\n    width: 100%;\r\n    border-radius: 8rpx;\r\n    overflow: hidden;\r\n    margin-bottom: 20rpx;\r\n}\r\n\r\n.video-preview video {\r\n    width: 100%;\r\n    height: 400rpx;\r\n}\r\n\r\n.video-controls {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    padding: 10rpx 0;\r\n}\r\n\r\n.video-delete-btn {\r\n    background-color: #ff4d4f;\r\n    color: #fff;\r\n    padding: 10rpx 20rpx;\r\n    border-radius: 8rpx;\r\n    font-size: 28rpx;\r\n}\r\n\r\n.video-upload {\r\n    width: 100%;\r\n    height: 200rpx;\r\n    background: #f8f8f8;\r\n    border-radius: 8rpx;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n    color: #999;\r\n}\r\n\r\n.video-upload .cuIcon-video {\r\n    font-size: 48rpx;\r\n    margin-bottom: 10rpx;\r\n}\r\n\r\n.video-tip {\r\n    font-size: 24rpx;\r\n    color: #999;\r\n    margin-top: 10rpx;\r\n    padding-left: 10rpx;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./collect.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./collect.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1761229024486\n      var cssReload = require(\"D:/tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}