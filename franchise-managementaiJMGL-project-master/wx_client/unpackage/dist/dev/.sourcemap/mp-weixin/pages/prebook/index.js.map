{"version":3,"sources":["uni-app:///main.js","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/pages/prebook/index.vue?0dfd","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/pages/prebook/index.vue?0b16","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/pages/prebook/index.vue?b7ac","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/pages/prebook/index.vue?2be2","uni-app:///pages/prebook/index.vue","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/pages/prebook/index.vue?a9b9","webpack:///D:/上海永熵/franchise-managementaiJMGL-project/wx_client/pages/prebook/index.vue?2b09"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","activeTab","appointmentList","isRefreshing","isLoading","computed","filteredList","console","onLoad","uni","url","onShow","onPullDownRefresh","methods","switchTab","getPendingCount","getConfirmedCount","getStatusClass","getStatusText","formatDate","refreshData","getAppointmentList","title","clientId","then","item","inviteStatus","id","icon","catch","confirmAppointment","content","success","submitConfirmation","util","showCancelDialog","confirmText","cancelText","phoneNumber"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACqC;;;AAGzF;AACsM;AACtM,gBAAgB,6MAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AClCA;AAAA;AAAA;AAAA;AAAixB,CAAgB,+wBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACqFryB;AAEA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAHA;AAAA,eAKA;EACAC;IACA;MACAC;MAAA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACAC;MAAA;MACAC;MAEA;QACAA;QACA;MACA;;MAEA;MACA;QACA;UACAA;UACA;QACA;QACA;UACAA;UACA;QACA;QACA;MACA;MAEAA;;MAEA;MACA;QACA;QACA;MACA;MAEAA;MACA;IACA;EACA;EACAC;IACA;IACA;IACA;MACAC;QACAC;MACA;MACA;IACA;IAEAH;IACA;IACA;MACAE;QACAC;MACA;IACA;MACA;IACA;EACA;EACAC;IACA;IACA;EACA;EAEA;EACAC;IACA;EACA;EAEAC;IACA;IACAC;MAAA;MACA;MAEA;MACAP;;MAEA;MACA;QACAA;MACA;IACA;IAEA;IACAQ;MACA;MACA;QAAA;MAAA;IACA;IAEA;IACAC;MACA;MACA;QAAA;MAAA;IACA;IAEA;IACAC;MACA;MACA;QACA;QACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACA;QACA;QACA;QACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MAEA;QACA;QACA;QACA;QACA;QACA;MACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MAAA;MACA;QACA;MACA;MAEA;QACA;UACA;UACAX;QACA;MACA;IACA;IAEA;IACAY;MAAA;MACA;MAEA;MACAZ;QACAa;MACA;MAEA;QACAC;MACA,2CACAC;QACAf;QACA;QAEAF;QAEA;UACA;UACA;;UAEA;UACA;YACA;cACAP;YACA;cACAA;YACA;cACAO;cACAP;YACA;UACA;UAEAO;;UAEA;UACAP;YACA;cACAO;cACA;YACA;YACA;cACAA;cACA;YACA;YACA;UACA;YACA,oDACAkB;cACA;cACAC;cACA;cACAC;YAAA,EACA;YACApB;YACA;UACA;UAEAA;UACAA;YAAA;UAAA;UACAA;YAAA;UAAA;;UAEA;UACA;UACA;QACA;UACAE;YACAa;YACAM;UACA;QACA;MACA,GACAC;QACApB;QACA;QAEAA;UACAa;UACAM;QACA;QACArB;MACA;IACA;IAEA;IACAuB;MAAA;MACArB;QACAa;QACAS;QACAC;UACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MACAxB;QAAAa;MAAA;MAEAY;QACAP;MACA,4CACAH;QACAf;QAEA;UACAA;YACAa;YACAM;UACA;;UAEA;UACA;QACA;UACAnB;YACAa;YACAM;UACA;QACA;MACA,GACAC;QACApB;QACAA;UACAa;UACAM;QACA;QACArB;MACA;IACA;IAEA;IACA4B;MACA1B;QACAa;QACAS;QACAK;QACAC;QACAL;UACA;YACAvB;cACA6B;YACA;UACA;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACrYA;AAAA;AAAA;AAAA;AAAkoC,CAAgB,4lCAAG,EAAC,C;;;;;;;;;;;ACAtpC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/prebook/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/prebook/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=363615e6&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=363615e6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"363615e6\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/prebook/index.vue\"\nexport default component.exports","export * from \"-!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=363615e6&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = _vm.getPendingCount()\n  var m1 = m0 > 0 ? _vm.getPendingCount() : null\n  var m2 = _vm.getConfirmedCount()\n  var m3 = m2 > 0 ? _vm.getConfirmedCount() : null\n  var l0 = _vm.__map(_vm.filteredList, function (item, index) {\n    var $orig = _vm.__get_orig(item)\n    var m4 = item ? _vm.formatDate(item.invitationTime) : null\n    return {\n      $orig: $orig,\n      m4: m4,\n    }\n  })\n  var g0 = _vm.filteredList.length\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n        m1: m1,\n        m2: m2,\n        m3: m3,\n        l0: l0,\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"container\">\n\t\t<!-- Tab栏 -->\n\t\t<view class=\"tab-container\">\n\t\t\t<view class=\"tab-item\" :class=\"{ active: activeTab === 0 }\" @click=\"switchTab(0)\">\n\t\t\t\t<text class=\"tab-text\">待确认</text>\n\t\t\t\t<view class=\"tab-badge\" v-if=\"getPendingCount() > 0\">{{ getPendingCount() }}</view>\n\t\t\t</view>\n\t\t\t<view class=\"tab-item\" :class=\"{ active: activeTab === 1 }\" @click=\"switchTab(1)\">\n\t\t\t\t<text class=\"tab-text\">已确认</text>\n\t\t\t\t<view class=\"tab-badge\" v-if=\"getConfirmedCount() > 0\">{{ getConfirmedCount() }}</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 预约列表 -->\n\t\t<scroll-view class=\"list-container\" scroll-y>\n\t\t\t<!-- 简化但完整的列表项 -->\n\t\t\t<view class=\"appointment-card\" v-for=\"(item, index) in filteredList\" :key=\"index\" v-if=\"item\">\n\t\t\t\t<!-- 状态标签 -->\n\t\t\t\t<view class=\"status-tag\" :style=\"{ backgroundColor: item.inviteStatus == 0 ? '#ff9500' : '#34c759', color: '#fff', padding: '4px 8px', borderRadius: '4px', fontSize: '12px', marginBottom: '10px', display: 'inline-block' }\">\n\t\t\t\t\t{{ item.inviteStatus == 0 ? '待确认' : '已确认' }}\n\t\t\t\t</view>\n\n\t\t\t\t<!-- 预约时间 -->\n\t\t\t\t<view style=\"margin-bottom: 10px;\">\n\t\t\t\t\t<text style=\"font-size: 16px; font-weight: bold; color: #333;\">{{ formatDate(item.invitationTime) }}  </text>\n\t\t\t\t\t<text style=\"font-size: 16px; font-weight: bold; color: #333;margin-left: 15px;\">{{ item.timeMoment }}</text>\n\t\t\t\t</view>\n\n\t\t\t\t<!-- 预约地点 -->\n\t\t\t\t<view style=\"margin-bottom: 10px;\">\n\t\t\t\t\t<text style=\"font-size: 14px; color: #666;\">预约地点：</text>\n\t\t\t\t\t<text style=\"font-size: 14px; color: #333;\">{{ item.invitePlace}}</text>\n\t\t\t\t</view>\n\n\t\t\t\t<!-- 专属经理 -->\n\t\t\t\t<view style=\"margin-bottom: 10px;\">\n\t\t\t\t\t<text style=\"font-size: 14px; color: #666;\">专属经理：</text>\n\t\t\t\t\t<text style=\"font-size: 14px; color: #333;\">{{ item.guideName }} {{ item.phone }}</text>\n\t\t\t\t</view>\n\n\t\t\t\t<!-- 预约详情 -->\n\t\t\t\t<view style=\"margin-bottom: 15px;\">\n\t\t\t\t\t<text style=\"font-size: 14px; color: #666;\">预约描述：</text>\n\t\t\t\t\t<text style=\"font-size: 14px; color: #333; line-height: 1.4;\">{{ item.invitationDesc }}</text>\n\t\t\t\t</view>\n\t\t\t\t<!-- 确认参加按钮（仅待确认状态显示） -->\n\t\t\t\t<view v-if=\"item.inviteStatus == 0\" style=\"text-align: center; margin-top: 15px;\">\n\t\t\t\t\t<button \n\t\t\t\t\t\tclass=\"confirm-btn\"\n\t\t\t\t\t\t@click=\"confirmAppointment(item)\">\n\t\t\t\t\t\t☑ 确认参加\n\t\t\t\t\t</button>\n\t\t\t\t\t<view style=\"margin-top: 10px;\">\n\t\t\t\t\t\t<text \n\t\t\t\t\t\t\tstyle=\"font-size: 12px; color: #000;\">\n\t\t\t\t\t\t\t时间不便？请直接与专属顾问沟通\n\t\t\t\t\t\t</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t\t<!-- 已确认状态显示 -->\n\t\t\t\t<view v-if=\"item.inviteStatus == 1\" style=\"text-align: center; margin-top: 15px; padding: 10px; background-color: #f0f9ff; border-radius: 6px;\">\n\t\t\t\t\t<text style=\"font-size: 14px; color: #34c759; font-weight: bold;\">✓ 已确认参加</text>\n\t\t\t\t\t<view style=\"margin-top: 5px;\">\n\t\t\t\t\t\t<text style=\"font-size: 12px; color: #666;\">请按时到达预约地点</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<!-- 空状态 -->\n\t\t\t<view v-if=\"filteredList.length === 0\" style=\"text-align: center; padding: 50px 20px;\">\n\t\t\t\t<text style=\"font-size: 16px; color: #999;\">{{ activeTab === 0 ? '暂无待确认的预约' : '暂无已确认的预约' }}</text>\n\t\t\t</view>\n\t\t</scroll-view>\n\n\t\t<!-- 下拉刷新提示 -->\n\t\t<view class=\"refresh-tip\" v-if=\"isRefreshing\" style=\"text-align: center; padding: 10px;\">\n\t\t\t<text>正在刷新...</text>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nconst util = require(\"@/utils/util.js\")\nimport {\n\tgetUserInfo\n} from '@/utils/auth';\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tactiveTab: 0, // 0: 待确认, 1: 已确认\n\t\t\tappointmentList: [],\n\t\t\tisRefreshing: false,\n\t\t\tisLoading: false\n\t\t}\n\t},\n\tcomputed: {\n\t\t// 根据当前tab过滤列表\n\t\tfilteredList() {\n\t\t\tconsole.log('filteredList计算 - appointmentList:', this.appointmentList)\n\t\t\t\n\t\t\tif (!Array.isArray(this.appointmentList)) {\n\t\t\t\tconsole.warn('appointmentList不是数组:', this.appointmentList)\n\t\t\t\treturn []\n\t\t\t}\n\t\t\t\n\t\t\t// 先清理无效数据，再进行过滤\n\t\t\tconst validItems = this.appointmentList.filter((item, index) => {\n\t\t\t\tif (!item || typeof item !== 'object') {\n\t\t\t\t\tconsole.warn(`发现无效的item at index ${index}:`, item)\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (!item.hasOwnProperty('inviteStatus')) {\n\t\t\t\t\tconsole.warn(`item缺少inviteStatus字段 at index ${index}:`, item)\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t})\n\t\t\t\n\t\t\tconsole.log('有效数据项:', validItems)\n\t\t\t\n\t\t\t// 根据activeTab过滤数据\n\t\t\tconst filtered = validItems.filter(item => {\n\t\t\t\tconst status = parseInt(item.inviteStatus)\n\t\t\t\treturn status === this.activeTab\n\t\t\t})\n\t\t\t\n\t\t\tconsole.log(`当前tab: ${this.activeTab}, 过滤后数据:`, filtered)\n\t\t\treturn filtered\n\t\t}\n\t},\n\tonLoad() {\n\t\t// 页面加载时获取预约列表\n\t\tconst userInfo = getUserInfo()\n\t\tif (!userInfo) {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: '/pages/login/login',\n\t\t\t})\n\t\t\treturn\n\t\t}\n\t\t\n\t\tconsole.log(\"userInfo.customerType\", userInfo.customerType)\n\t\t//customerType  没有提交问卷=0;  提交问卷没有预约=1;  预约了=2;  签约了的=3 不是客户 = 4\n\t\tif (userInfo.customerType == 0) {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: '/pages/question/index',\n\t\t\t})\n\t\t} else {\n\t\t\tthis.getAppointmentList()\n\t\t}\n\t},\n\tonShow() {\n\t\t// 页面显示时刷新数据\n\t\tthis.refreshData()\n\t},\n\t\n\t// 下拉刷新\n\tonPullDownRefresh() {\n\t\tthis.refreshData(true)\n\t},\n\t\n\tmethods: {\n\t\t// 切换tab\n\t\tswitchTab(index) {\n\t\t\tif (this.activeTab === index) return\n\t\t\t\n\t\t\tthis.activeTab = index\n\t\t\tconsole.log(`切换到tab: ${index === 0 ? '待确认' : '已确认'}`)\n\t\t\t\n\t\t\t// 可以添加切换动画效果\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tconsole.log(`当前显示${this.filteredList.length}条数据`)\n\t\t\t})\n\t\t},\n\n\t\t// 获取待确认数量\n\t\tgetPendingCount() {\n\t\t\tif (!Array.isArray(this.appointmentList)) return 0\n\t\t\treturn this.appointmentList.filter(item => parseInt(item.inviteStatus) === 0).length\n\t\t},\n\n\t\t// 获取已确认数量\n\t\tgetConfirmedCount() {\n\t\t\tif (!Array.isArray(this.appointmentList)) return 0\n\t\t\treturn this.appointmentList.filter(item => parseInt(item.inviteStatus) === 1).length\n\t\t},\n\n\t\t// 获取状态样式类\n\t\tgetStatusClass(status) {\n\t\t\tconst statusNum = parseInt(status)\n\t\t\treturn {\n\t\t\t\t'status-pending': statusNum === 0,\n\t\t\t\t'status-confirmed': statusNum === 1,\n\t\t\t\t'status-cancelled': statusNum === 2\n\t\t\t}\n\t\t},\n\n\t\t// 获取状态文本\n\t\tgetStatusText(status) {\n\t\t\tconst statusNum = parseInt(status)\n\t\t\tconst statusMap = {\n\t\t\t\t0: '待确认',\n\t\t\t\t1: '已确认',\n\t\t\t\t2: '已取消'\n\t\t\t}\n\t\t\treturn statusMap[statusNum] || '未知状态'\n\t\t},\n\n\t\t// 格式化日期\n\t\tformatDate(dateStr) {\n\t\t\tif (!dateStr) return '日期待定'\n\t\t\t\n\t\t\ttry {\n\t\t\t\tconst date = new Date(dateStr)\n\t\t\t\tconst year = date.getFullYear()\n\t\t\t\tconst month = String(date.getMonth() + 1).padStart(2, '0')\n\t\t\t\tconst day = String(date.getDate()).padStart(2, '0')\n\t\t\t\treturn `${year}年${month}月${day}日`\n\t\t\t} catch (e) {\n\t\t\t\treturn dateStr\n\t\t\t}\n\t\t},\n\n\t\t// 刷新数据\n\t\trefreshData(isPullRefresh = false) {\n\t\t\tif (isPullRefresh) {\n\t\t\t\tthis.isRefreshing = true\n\t\t\t}\n\t\t\t\n\t\t\tthis.getAppointmentList().finally(() => {\n\t\t\t\tif (isPullRefresh) {\n\t\t\t\t\tthis.isRefreshing = false\n\t\t\t\t\tuni.stopPullDownRefresh()\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\n\t\t// 获取预约列表\n\t\tgetAppointmentList() {\n\t\t\tif (this.isLoading) return Promise.resolve()\n\t\t\t\n\t\t\tthis.isLoading = true\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: '加载中...'\n\t\t\t})\n\n\t\t\treturn util.request('wx/api/inviteList', {\n\t\t\t\tclientId: getUserInfo().clientId\n\t\t\t}, 'GET', 'application/json', false, true)\n\t\t\t\t.then(res => {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\tthis.isLoading = false\n\t\t\t\t\t\n\t\t\t\t\tconsole.log('API响应:', res)\n\t\t\t\t\t\n\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\t// 确保数据是数组格式\n\t\t\t\t\t\tlet data = res.data || []\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 处理不同的数据结构\n\t\t\t\t\t\tif (!Array.isArray(data)) {\n\t\t\t\t\t\t\tif (data.list && Array.isArray(data.list)) {\n\t\t\t\t\t\t\t\tdata = data.list\n\t\t\t\t\t\t\t} else if (data.items && Array.isArray(data.items)) {\n\t\t\t\t\t\t\t\tdata = data.items\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.warn('数据格式异常，使用空数组')\n\t\t\t\t\t\t\t\tdata = []\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconsole.log('API原始数据:', data)\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 数据预处理 - 更严格的验证\n\t\t\t\t\t\tdata = data.filter((item, index) => {\n\t\t\t\t\t\t\tif (!item || typeof item !== 'object') {\n\t\t\t\t\t\t\t\tconsole.warn(`过滤掉无效数据项 at index ${index}:`, item)\n\t\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!item.hasOwnProperty('inviteStatus')) {\n\t\t\t\t\t\t\t\tconsole.warn(`过滤掉缺少inviteStatus的数据项 at index ${index}:`, item)\n\t\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true\n\t\t\t\t\t\t}).map((item, index) => {\n\t\t\t\t\t\t\tconst processedItem = {\n\t\t\t\t\t\t\t\t...item,\n\t\t\t\t\t\t\t\t// 确保inviteStatus是数字类型\n\t\t\t\t\t\t\t\tinviteStatus: parseInt(item.inviteStatus) || 0,\n\t\t\t\t\t\t\t\t// 添加唯一ID（如果没有的话）\n\t\t\t\t\t\t\t\tid: item.id || `appointment_${Date.now()}_${index}_${Math.random()}`\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconsole.log(`处理数据项 ${index}:`, processedItem)\n\t\t\t\t\t\t\treturn processedItem\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\n\t\t\t\t\t\tconsole.log('最终处理后的数据:', data)\n\t\t\t\t\t\tconsole.log('待确认数量:', data.filter(item => item.inviteStatus === 0).length)\n\t\t\t\t\t\tconsole.log('已确认数量:', data.filter(item => item.inviteStatus === 1).length)\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 使用Vue.set确保响应式更新\n\t\t\t\t\t\tthis.$set(this, 'appointmentList', data)\n\t\t\t\t\t\t// 或者使用 this.appointmentList = data\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: res.message || '获取预约列表失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\tthis.isLoading = false\n\t\t\t\t\t\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '网络异常，请稍后再试',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\tconsole.error('获取预约列表失败', err)\n\t\t\t\t})\n\t\t},\n\n\t\t// 确认参加预约\n\t\tconfirmAppointment(item) {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '确认参加',\n\t\t\t\tcontent: `确认参加${this.formatDate(item.invitationTime)} ${item.timeMoment || ''}的预约邀请吗？`,\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\tthis.submitConfirmation(item)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\n\t\t// 提交确认\n\t\tsubmitConfirmation(item) {\n\t\t\tuni.showLoading({ title: '确认中...' })\n\n\t\t\tutil.request('wx/api/confirmInvite', {\n\t\t\t\tid: item.id\n\t\t\t}, 'POST', 'application/json', false, true)\n\t\t\t\t.then(res => {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\n\t\t\t\t\tif (res.code === 200) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '确认成功',\n\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 刷新列表\n\t\t\t\t\t\tthis.getAppointmentList()\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: res.message || '确认失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '网络异常，请稍后再试',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\tconsole.error('确认预约失败', err)\n\t\t\t\t})\n\t\t},\n\n\t\t// 显示取消对话框\n\t\tshowCancelDialog(item, index) {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '联系专属顾问',\n\t\t\t\tcontent: `如需调整预约时间，请联系专属顾问：${item.managerName || '王经理'} ${item.managerPhone || '138****8888'}`,\n\t\t\t\tconfirmText: '拨打电话',\n\t\t\t\tcancelText: '取消',\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\tuni.makePhoneCall({\n\t\t\t\t\t\t\tphoneNumber: item.managerPhone || '13800000000'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n}\n</script>\n\n<style scoped>\n.container {\n\tmin-height: 100vh;\n\tbackground-color: #f5f5f5;\n}\n\n/* Tab栏样式 */\n.tab-container {\n\tdisplay: flex;\n\tbackground-color: #fff;\n\tborder-bottom: 1px solid #e5e5e5;\n\tposition: sticky;\n\ttop: 0;\n\tz-index: 100;\n}\n\n.tab-item {\n\tflex: 1;\n\tpadding: 15px 0;\n\ttext-align: center;\n\tposition: relative;\n\ttransition: all 0.3s ease;\n}\n\n.tab-item.active {\n\tcolor: #007aff;\n\tborder-bottom: 2px solid #007aff;\n}\n\n.tab-text {\n\tfont-size: 16px;\n\tfont-weight: 500;\n}\n\n.tab-badge {\n\tposition: absolute;\n\ttop: 8px;\n\tright: 20px;\n\tbackground-color: #ff3b30;\n\tcolor: white;\n\tfont-size: 12px;\n\tpadding: 2px 6px;\n\tborder-radius: 10px;\n\tmin-width: 18px;\n\theight: 18px;\n\tline-height: 14px;\n\ttext-align: center;\n}\n\n/* 列表容器 */\n.list-container {\n\tflex: 1;\n\tpadding: 10px;\n}\n\n/* 预约卡片 */\n.appointment-card {\n\tbackground-color: #fff;\n\tborder-radius: 8px;\n\tpadding: 15px;\n\tmargin-bottom: 10px;\n\tbox-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n/* 刷新提示 */\n.refresh-tip {\n\tposition: fixed;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n\tbackground-color: rgba(0,0,0,0.7);\n\tcolor: white;\n\tpadding: 10px 20px;\n\tborder-radius: 4px;\n\tz-index: 1000;\n}\n\n/* 确认按钮样式 */\n.confirm-btn {\n\tbackground-color: #28a745;\n\tcolor: white;\n\tborder: none;\n\tpadding: 10px 20px;\n\tborder-radius: 6px;\n\tfont-size: 16px;\n\tcursor: pointer;\n\ttransition: background-color 0.3s ease;\n}\n\n.confirm-btn:hover {\n\tbackground-color: #218838;\n}\n</style>\n\n","import mod from \"-!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=363615e6&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=363615e6&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1761229024470\n      var cssReload = require(\"D:/tools/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}