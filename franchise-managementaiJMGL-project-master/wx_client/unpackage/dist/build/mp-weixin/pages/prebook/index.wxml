<view class="container"><view class="calendar-container"><view class="week-header"><block wx:for="{{weekDays}}" wx:for-item="day" wx:for-index="index" wx:key="index"><view class="week-day">{{''+day+''}}</view></block></view><view class="week-dates"><block wx:for="{{weekDates}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['selectDate',['$0'],[[['weekDates','',index]]]]]]]}}" class="{{['date-item',(selectedDate===item.date)?'active':'']}}" bindtap="__e">{{''+item.day+''}}</view></block></view></view><view class="appointment-list"><view class="list-title">我的预约</view><scroll-view class="list-content" scroll-y="{{true}}"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="appointment-wrapper"><view data-event-opts="{{[['touchstart',[['touchStart',['$event',index]]]],['touchmove',[['touchMove',['$event',index]]]],['touchend',[['touchEnd',['$event',index]]]]]}}" class="appointment-item" style="{{'transform:'+('translateX('+(item.$orig.translateX||0)+'rpx)')+';'}}" bindtouchstart="__e" bindtouchmove="__e" bindtouchend="__e"><view class="item-date">{{item.$orig.invitationTime}}</view><view class="item-time">{{item.$orig.timeMoment}}</view><view class="{{['item-status',(item.$orig.inviteStatus===0)?'pending':'',(item.$orig.inviteStatus===1)?'confirmed':'',(item.$orig.inviteStatus===2)?'cancelled':'']}}">{{item.m0}}</view></view><view data-event-opts="{{[['tap',[['showCancelDialog',[index]]]]]}}" class="delete-btn" bindtap="__e">取消</view></view></block><block wx:if="{{$root.g0===0}}"><view class="empty-tip">暂无预约记录</view></block></scroll-view></view><block wx:if="{{showTimePopup}}"><view data-event-opts="{{[['tap',[['closePopup',['$event']]]]]}}" class="popup-mask" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="time-popup" catchtap="__e"><view class="popup-header"><text class="popup-title">选择预约时间</text><text class="popup-date">{{selectedDateText}}</text></view><view class="time-section"><view class="section-title">上午</view><view class="time-grid"><block wx:for="{{morningSlots}}" wx:for-item="slot" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['selectTimeSlot',['$0'],[[['morningSlots','',index]]]]]]]}}" class="{{['time-slot',(slot.isBooked)?'booked':'',(!slot.isBooked)?'available':'',(selectedTimeSlot===slot.time)?'selected':'']}}" bindtap="__e"><text class="slot-time">{{slot.time}}</text><text class="slot-status">{{slot.isBooked?'已预约':'可预约'}}</text></view></block></view></view><view class="time-section"><view class="section-title">下午</view><view class="time-grid"><block wx:for="{{afternoonSlots}}" wx:for-item="slot" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['selectTimeSlot',['$0'],[[['afternoonSlots','',index]]]]]]]}}" class="{{['time-slot',(slot.isBooked)?'booked':'',(!slot.isBooked)?'available':'',(selectedTimeSlot===slot.time)?'selected':'']}}" bindtap="__e"><text class="slot-time">{{slot.time}}</text><text class="slot-status">{{slot.isBooked?'已预约':'可预约'}}</text></view></block></view></view><view class="popup-buttons"><button data-event-opts="{{[['tap',[['closePopup',['$event']]]]]}}" class="btn-cancel" bindtap="__e">取消</button><button class="btn-confirm" disabled="{{!selectedTimeSlot}}" data-event-opts="{{[['tap',[['confirmAppointment',['$event']]]]]}}" bindtap="__e">确定</button></view></view></view></block></view>